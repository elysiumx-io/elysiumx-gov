import{A as C,S as g}from"./loadSts-CbsokfCw.js";import{c as P,d as _,f as F,g as K,C as $,E as q,h as H,I as U,e as M,M as N,P as z,R as j,b as B,a as G}from"./loadSts-CbsokfCw.js";import{s as c}from"./index-AWWvwHFC.js";import{a as V,C as J}from"./index-AWWvwHFC.js";import"./date-utils-SiQQdCwh.js";import"./noAuth-BRTlyyWt.js";import"./create-aggregated-client-sX0lpe6c.js";import"./index-BNM2Gi5R.js";const l="us-east-1",A=e=>{if(typeof e?.Arn=="string"){const t=e.Arn.split(":");if(t.length>4&&t[4]!=="")return t[4]}},E=async(e,t,s)=>{const o=typeof e=="function"?await e():e,n=typeof t=="function"?await t():t;return s?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${o} (provider)`,`${n} (parent client)`,`${l} (STS default)`),o??n??l},R=(e,t)=>{let s;return async o=>{if(!s){const{logger:u=e?.parentClientConfig?.logger,region:m,requestHandler:a=e?.parentClientConfig?.requestHandler,credentialProviderLogger:p}=e,S=await E(m,e?.parentClientConfig?.region,p),f=!I(a);s=new t({profile:e?.parentClientConfig?.profile,region:S,requestHandler:f?a:void 0,logger:u})}const{Credentials:n,AssumedRoleUser:d}=await s.send(new C(o));if(!n||!n.AccessKeyId||!n.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${o.RoleArn}`);const i=A(d),r={accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,sessionToken:n.SessionToken,expiration:n.Expiration,...n.CredentialScope&&{credentialScope:n.CredentialScope},...i&&{accountId:i}};return i&&c(r,"RESOLVED_ACCOUNT_ID","T"),c(r,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),r}},I=e=>e?.metadata?.handlerProtocol==="h2",y=(e,t)=>t?class extends e{constructor(o){super(o);for(const n of t)this.middlewareStack.use(n)}}:e,D=(e={},t)=>R(e,y(g,t));export{V as $Command,P as AssumeRoleCommand,_ as AssumeRoleResponseFilterSensitiveLog,C as AssumeRoleWithWebIdentityCommand,F as AssumeRoleWithWebIdentityRequestFilterSensitiveLog,K as AssumeRoleWithWebIdentityResponseFilterSensitiveLog,$ as CredentialsFilterSensitiveLog,q as ExpiredTokenException,H as IDPCommunicationErrorException,U as IDPRejectedClaimException,M as InvalidIdentityTokenException,N as MalformedPolicyDocumentException,z as PackedPolicyTooLargeException,j as RegionDisabledException,B as STS,g as STSClient,G as STSServiceException,J as __Client,D as getDefaultRoleAssumerWithWebIdentity};
