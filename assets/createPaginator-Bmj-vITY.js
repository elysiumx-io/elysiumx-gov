const w=async(r,s,e,o=n=>n,...t)=>{let n=new r(e);return n=o(n)??n,await s.send(n,...t)};function m(r,s,e,o,t){return async function*(a,d,...p){const i=d;let c=a.startingToken??i[e],u=!0,l;for(;u;){if(i[e]=c,t&&(i[t]=i[t]??a.pageSize),a.client instanceof r)l=await w(s,a.client,d,a.withCommand,...p);else throw new Error(`Invalid client, expected instance of ${r.name}`);yield l;const f=c;c=h(l,o),u=!!(c&&(!a.stopOnSameToken||c!==f))}return void 0}}const h=(r,s)=>{let e=r;const o=s.split(".");for(const t of o){if(!e||typeof e!="object")return;e=e[t]}return e};export{m as c};
